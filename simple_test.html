<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Dashboard Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .card { background: #f5f5f5; padding: 20px; margin: 10px 0; border-radius: 8px; }
        .error { color: red; background: #ffe6e6; padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { color: green; background: #e6ffe6; padding: 10px; margin: 10px 0; border-radius: 4px; }
        select, button { padding: 10px; margin: 5px; }
        #debugInfo { background: #f0f0f0; padding: 10px; margin: 10px 0; font-family: monospace; white-space: pre-wrap; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Simple Dashboard Test</h1>
        
        <div class="card">
            <h3>Data File Selection</h3>
            <select id="dataFileSelect">
                <option value="">Select a data file...</option>
                <option value="./data/Sunday, 16 November 2025 1329+1251 v 3144363.json">Sunday 16 Nov</option>
                <option value="./data/Monday, 24 November 2025 1329+1251 v 683+665.json">Monday 24 Nov</option>
                <option value="./data/scoreboard-data.json">Scoreboard Data</option>
            </select>
            <button id="loadBtn">Load Data</button>
            <button id="refreshBtn">Refresh</button>
        </div>
        
        <div id="debugInfo"></div>
        <div id="output"></div>
    </div>

    <script src="dashboard.js"></script>
    <script>
        const debugInfo = document.getElementById('debugInfo');
        const output = document.getElementById('output');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            debugInfo.textContent += `[${timestamp}] ${message}\n`;
            
            const div = document.createElement('div');
            div.className = type;
            div.textContent = message;
            output.appendChild(div);
        }
        
        // Override console.log to capture dashboard messages
        const originalConsoleLog = console.log;
        console.log = function(...args) {
            originalConsoleLog.apply(console, args);
            log(args.join(' '), 'info');
        };
        
        // Test dashboard functionality
        document.addEventListener('DOMContentLoaded', async () => {
            log('DOM loaded, testing dashboard...');
            
            try {
                // Test 1: Create dashboard instance
                log('Creating Dashboard instance...');
                const dashboard = new Dashboard();
                log('✓ Dashboard instance created successfully', 'success');
                
                // Test 2: Check methods
                log('Checking dashboard methods...');
                const methods = ['loadData', 'refreshData', 'displayData', 'calculateMetrics'];
                methods.forEach(method => {
                    if (typeof dashboard[method] === 'function') {
                        log(`✓ ${method} method exists`, 'success');
                    } else {
                        log(`✗ ${method} method missing`, 'error');
                    }
                });
                
                // Test 3: Load data manually
                document.getElementById('loadBtn').addEventListener('click', async () => {
                    const select = document.getElementById('dataFileSelect');
                    if (select.value) {
                        log(`Loading data from: ${select.value}`);
                        try {
                            await dashboard.loadData(select.value);
                            log('✓ Data loaded successfully', 'success');
                        } catch (error) {
                            log(`✗ Error loading data: ${error.message}`, 'error');
                        }
                    }
                });
                
                // Test 4: Refresh button
                document.getElementById('refreshBtn').addEventListener('click', () => {
                    log('Refreshing data...');
                    dashboard.refreshData();
                });
                
                log('Dashboard test setup complete', 'success');
                
            } catch (error) {
                log(`✗ Error setting up dashboard: ${error.message}`, 'error');
                console.error(error);
            }
        });
    </script>
</body>
</html>